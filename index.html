<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>ADHD helper</title>

<style>
  body {
    font-family: Arial, sans-serif;
    background: #eef0ff;
    padding: 30px;
    text-align: center;
    transition: 0.3s;
  }
  body.dark { background: #1e1e2f; color: #f1f1f1; }

  /* ì™¼ìª½ íŒ¨ë„ */
  #left-panel {
    position: fixed; top: 20px; left: 20px;
    width: 260px; z-index: 9999;
    display: flex; flex-direction: column; gap: 15px;
  }

  /* ì¹­ì°¬ ë©”ì‹œì§€ */
  .praise-msg {
    background: #ffe066; color: black;
    padding: 20px 24px; border-radius: 14px;
    font-size: 36px; font-weight: bold;
    animation: fadeout 2.2s forwards ease-out;
  }
  @keyframes fadeout {
    0% {opacity:1; transform:translateY(0);}
    70%{opacity:1;}
    100%{opacity:0; transform:translateY(-16px);}
  }

  .badge { background: gold; padding:6px 10px; border-radius:6px; font-size:22px; width:fit-content; margin-bottom:4px; }
  .badge-big { background: gold; padding:10px 14px; border-radius:10px; font-size:40px; width:fit-content; margin-bottom:4px; }

  /* ê°€ìš´ë° ì»¨í…Œì´ë„ˆ */
  .container {
    width: 550px; margin: 0 auto;
    background:white; padding:25px;
    border-radius:14px; box-shadow:0 4px 14px rgba(0,0,0,0.1);
    position:relative; z-index:5;
  }
  body.dark .container { background:#2c2c3b; }

  /* ì˜¤ë¥¸ìª½ ë©”ëª¨ íŒ¨ë„ â€“ ë‹¤í¬ëª¨ë“œ ì™„ì „ ì ìš© */
  #right-panel {
    position: fixed;
    top: 30px;
    left: calc(50% + 330px);
    width: 260px;
    background: white;
    color: black;
    padding: 14px;
    border-radius: 12px;
    box-shadow: 0 3px 12px rgba(0,0,0,0.1);
    pointer-events: none; 
    z-index: 1;
  }

  /* â˜… ë‹¤í¬ëª¨ë“œ ë°˜ì˜ */
  body.dark #right-panel {
    background: #2c2c3b;
    color: #f1f1f1;
  }
  body.dark .memo-item {
    background: #3d3d4e !important;
    color: #f1f1f1 !important;
  }

  #right-panel * { pointer-events:auto; position:relative; z-index:9999; }

  #memo-input {
    width:90%; padding:8px; border-radius:6px;
    border:1px solid #aaa; margin-bottom:6px;
  }
  #memo-list { margin-top: 12px; }
  .memo-item {
    background:#f7f7f7; padding:6px;
    border-radius:6px; margin-bottom:6px;
    display:flex; justify-content:space-between;
  }
  .memo-del { cursor:pointer; color:red; font-size:14px; }

  /* íƒ€ì´ë¨¸ */
  #circle-wrapper {
    position: relative;
    width: 300px; height: 300px;
    margin: 25px auto;
    display: none;
  }
  svg { width:300px; height:300px; transform:rotate(-90deg); }
  #circle-bg { stroke:#bbb; stroke-width:14; fill:none; }
  body.dark #circle-bg { stroke:#555; }
  #circle-progress { stroke:#6c63ff; stroke-width:14; fill:none; stroke-linecap:round; transition:stroke-dashoffset 1s linear; }
  body.dark #circle-progress { stroke:#a79bff; }

  #timer-digital {
    position:absolute; top:50%; left:50%;
    transform:translate(-50%, -55%);
    font-size:38px; font-weight:bold;
  }

  /* â˜… ì¼ì‹œì •ì§€ ì˜¤ë²„ë ˆì´ â˜… */
  #pause-overlay {
    position:absolute; top:0; left:0;
    width:300px; height:300px;
    background:rgba(0,0,0,0.45);
    border-radius:50%;
    display:flex; align-items:center; justify-content:center;
    font-size:40px; font-weight:bold;
    color:white;
    backdrop-filter:blur(2px);
    display:none;
    pointer-events:none;
  }

  /* â˜… ì¼ì‹œì •ì§€ ë²„íŠ¼ â€“ í…ìŠ¤íŠ¸, ì¤‘ì•™ ì •ë ¬, íƒ€ì´ë¨¸ ì˜¤ë¥¸ìª½ ì•„ë˜ â˜… */
  #pause-btn {
    position: absolute;
    bottom: -15px; 
    right: -15px;
    width: 60px; height: 60px;
    border-radius: 50%;
    font-size: 30px;
    font-weight: bold;
    display:flex; align-items:center; justify-content:center;

    background:#6c63ff; color:white;
    border:none; cursor:pointer;
    box-shadow:0 4px 12px rgba(0,0,0,0.25);

    display:none;
    z-index:99999;
  }
  #pause-btn:hover { background:#574ef6; }

  /* ë‹¤í¬ëª¨ë“œ ë²„íŠ¼ */
  #dark-toggle {
    position: fixed; top:20px; right:20px;
    padding:6px 12px; border-radius:8px;
    background:#444; color:white; cursor:pointer;
    border:none; z-index:9999;
  }
  body.dark #dark-toggle { background:#888; }

  input[type="text"] { width:80%; padding:10px; border-radius:6px; border:1px solid #ccc; }
  button { margin-top:10px; padding:10px 16px; border:none; border-radius:8px; background:#6c63ff; color:white; font-size:15px; cursor:pointer; }
  #skip-btn { background:#e65555; }
  #reset-btn { background:#e65555; }

  ul { list-style:none; padding:0; margin-left:40px; text-align:left; }
  li { margin-bottom:10px; display:flex; align-items:center; gap:6px; cursor:pointer; }

</style>
</head>

<body>

<!-- ì™¼ìª½ íŒ¨ë„ -->
<div id="left-panel">
  <div id="praise-list"></div>
  <div id="badge-list"></div>
</div>

<!-- ì˜¤ë¥¸ìª½ ë©”ëª¨ íŒ¨ë„ -->
<div id="right-panel">
  <h3 style="margin-top:0;">ë©”ëª¨</h3>
  <input id="memo-input" type="text" placeholder="ë©”ëª¨ ì‘ì„±">
  <button onclick="addMemo()" style="width:100%;">ì¶”ê°€</button>
  <div id="memo-list"></div>
</div>

<button id="dark-toggle" onclick="toggleDark()">ğŸŒ™ ë‹¤í¬ëª¨ë“œ</button>

<h1>ADHD í•  ì¼ ì‹œì‘ ë„ìš°ë¯¸</h1>

<div class="container">

  <h3>ğŸ“Œ í•  ì¼ ë“±ë¡</h3>
  <input id="task-input" type="text" placeholder="ì˜ˆ: ìˆ˜í•™ ë¬¸ì œ í’€ê¸°">

  <h3>ì§„í–‰ ì¤‘ì¸ í•  ì¼</h3>
  <ul id="task-active"></ul>

  <!-- íƒ€ì´ë¨¸ -->
  <div id="circle-wrapper">

    <svg>
      <circle id="circle-bg" cx="150" cy="150" r="130"></circle>
      <circle id="circle-progress" cx="150" cy="150" r="130"></circle>
    </svg>

    <div id="timer-digital">00:00</div>

    <!-- â˜… ì¼ì‹œì •ì§€ ì˜¤ë²„ë ˆì´ â˜… -->
    <div id="pause-overlay">ì¼ì‹œì •ì§€</div>

    <!-- â˜… íƒ€ì´ë¨¸ ìš°ì¸¡ ì•„ë˜ ì¼ì‹œì •ì§€ ë²„íŠ¼ â˜… -->
    <button id="pause-btn" onclick="togglePause()">â–¶</button>

  </div>

  <button onclick="startAll()">ì‹œì‘í•˜ê¸°</button>
  <button id="reset-btn" onclick="resetAll()">ì „ì²´ ë¦¬ì…‹</button>
  <button id="skip-btn" onclick="skip20()" style="display:none;">20ì´ˆ ìŠ¤í‚µ</button>

  <div id="mini-task" style="margin-top:20px; font-size:20px;"></div>

  <h3>ì™„ë£Œëœ í•  ì¼</h3>
  <ul id="task-done"></ul>

</div>

<script>
/* -----------------------------
   ê¸°ë³¸ ìƒíƒœ
------------------------------*/
let tasks = JSON.parse(localStorage.getItem("tasks") || "[]");
let stars = Number(localStorage.getItem("stars") || 0);
let memos = JSON.parse(localStorage.getItem("memos") || "[]");

let praiseMessages = [
  "ì™€.. ì§‘ì¤‘ë ¥ ë¯¸ì³¤ë‹¤ âœ¨","ì™€ ë„ˆ ì§„ì§œ ì²œì¬ì¸ë°?",
  "ì˜¤ëŠ˜ ì™œ ì´ë ‡ê²Œ ë©‹ìˆëƒ?","ì§‘ì¤‘ë ¥ ìƒíƒœ ìµœìƒê¸‰ ã„·ã„·",
  "ë„ˆ ì˜¤ëŠ˜ ë ˆì „ë“œë‹¤.","ì†”ì§íˆ ì²œì¬ ë§ì§€?",
  "ì™„ì „ ì§‘ì¤‘ë ¥ í­ë°œ âš¡","ì´ ì •ë„ë©´ ì¸ê°„ê³„ ì•„ë‹˜;",
  "ë„ˆ ì˜¤ëŠ˜ ë­ ë¨¹ì—ˆìŒ??"
];

let miniTasks = [
  "ì¢…ì´ í•œ ì¥ ì¹˜ìš°ê¸°","ì—°í•„ í•˜ë‚˜ ì •ë¦¬í•˜ê¸°",
  "ë¬¸ì œì§‘ í¼ì¹˜ê¸°","ì“°ë ˆê¸° í•˜ë‚˜ ë²„ë¦¬ê¸°","ë¬¼ í•œ ëª¨ê¸ˆ ë§ˆì‹œê¸°"
];

let baseTime = 900;
let fifteenLeft = baseTime;
let twentyTimer = null;
let fifteenTimer = null;

/* â˜… ì¼ì‹œì •ì§€ ìƒíƒœ â˜… */
let isPaused = false;

/* ì´ˆê¸° ë Œë” */
renderTasks(); renderBadges(); renderMemos();
if(localStorage.getItem("dark")==="true") document.body.classList.add("dark");

/* ë‹¤í¬ëª¨ë“œ */
function toggleDark(){
  document.body.classList.toggle("dark");
  localStorage.setItem("dark", document.body.classList.contains("dark"));
}

/* ë©”ëª¨ */
document.getElementById("memo-input").addEventListener("keypress",e=>{
  if(e.key==="Enter") addMemo();
});
function addMemo(){
  let t=document.getElementById("memo-input").value.trim();
  if(!t) return;
  memos.push(t);
  localStorage.setItem("memos", JSON.stringify(memos));
  document.getElementById("memo-input").value="";
  renderMemos();
}
function deleteMemo(i){
  memos.splice(i,1);
  localStorage.setItem("memos", JSON.stringify(memos));
  renderMemos();
}
function renderMemos(){
  const L=document.getElementById("memo-list");
  L.innerHTML="";
  memos.forEach((m,i)=>{
    L.innerHTML+=`<div class="memo-item"><span>${m}</span><span class="memo-del" onclick="deleteMemo(${i})">X</span></div>`;
  });
}

/* í• ì¼ */
document.getElementById("task-input").addEventListener("keypress",e=>{
  if(e.key==="Enter") addTask();
});
function addTask(){
  let t=document.getElementById("task-input").value.trim();
  if(!t) return;
  tasks.push({text:t, done:false});
  save(); renderTasks();
  document.getElementById("task-input").value="";
}

function renderTasks(){
  const active=document.getElementById("task-active");
  const done=document.getElementById("task-done");
  active.innerHTML=""; done.innerHTML="";

  tasks.forEach((t,i)=>{
    let li=document.createElement("li");
    li.setAttribute("onclick",`toggleTask(${i})`);

    li.innerHTML=`
      <input type="checkbox" ${t.done?"checked":""}
        onclick="event.stopPropagation(); toggleTask(${i})">
      <span>${t.done?"<s>"+t.text+"</s>":t.text}</span>
    `;

    if(t.done) done.appendChild(li); 
    else active.appendChild(li);
  });
}

function toggleTask(i){
  tasks[i].done=!tasks[i].done;
  save(); renderTasks();
  if(tasks[i].done){
    showPraise(); addStar(); handleTimerAfterComplete();
  }
}

function save(){
  localStorage.setItem("tasks", JSON.stringify(tasks));
  localStorage.setItem("stars", stars);
}

/* ì¹­ì°¬ */
function showPraise(){
  const A=document.getElementById("praise-list");
  let box=document.createElement("div");
  box.className="praise-msg";
  box.innerText=praiseMessages[Math.floor(Math.random()*praiseMessages.length)];
  A.appendChild(box);
  setTimeout(()=>box.remove(),2200);
}

/* ë°°ì§€ */
function addStar(){
  stars++; save(); renderBadges();
}
function renderBadges(){
  const area=document.getElementById("badge-list");
  area.innerHTML="";
  let comet=Math.floor(stars/6);
  let starR=stars%6;

  for(let i=0;i<comet;i++) area.innerHTML+=`<div class="badge-big">ğŸŒ </div>`;
  for(let i=0;i<starR;i++) area.innerHTML+=`<div class="badge">â­</div>`;
}

/* íƒ€ì´ë¨¸ */
function startAll(){
  if(tasks.filter(t=>!t.done).length===0) return alert("í•  ì¼ì´ ì—†ìŠµë‹ˆë‹¤!");

  generateMiniTask();
  document.getElementById("circle-wrapper").style.display="block";
  document.getElementById("skip-btn").style.display="inline-block";
  document.getElementById("pause-btn").style.display="flex";  // ë²„íŠ¼ í‘œì‹œ

  start20();
}

function generateMiniTask(){
  document.getElementById("mini-task").innerText="ğŸ‘‰ ì§€ê¸ˆ í•  í–‰ë™: "+miniTasks[Math.floor(Math.random()*miniTasks.length)];
}

function start20(){
  stopAllTimers();
  let s=20; updateDigital(s);

  twentyTimer=setInterval(()=>{
    if(isPaused) return;
    s--; updateDigital(s);

    if(s<=0){
      clearInterval(twentyTimer);
      document.getElementById("mini-task").innerText="";
      document.getElementById("skip-btn").style.display="none";
      start15();
    }
  },1000);
}

function skip20(){
  clearInterval(twentyTimer);
  document.getElementById("mini-task").innerText="";
  document.getElementById("skip-btn").style.display="none";
  start15();
}

function start15(){
  fifteenLeft=baseTime;

  fifteenTimer=setInterval(()=>{
    if(isPaused) return;
    fifteenLeft--; updateAnalog(); updateDigital(fifteenLeft);

    if(fifteenLeft<=0){
      addStar(); fifteenLeft=baseTime;
    }
  },1000);
}

function reset15(){ clearInterval(fifteenTimer); start15(); }

/* â˜… í• ì¼ ì™„ë£Œ ì‹œ íƒ€ì´ë¨¸ ì²˜ë¦¬ */
function handleTimerAfterComplete(){
  if(twentyTimer){
    clearInterval(twentyTimer);
    document.getElementById("mini-task").innerText="";
    document.getElementById("skip-btn").style.display="none";
  }
  reset15();
}

/* â˜… ì¼ì‹œì •ì§€ ê¸°ëŠ¥ */
function togglePause(){
  isPaused=!isPaused;

  const overlay=document.getElementById("pause-overlay");
  const btn=document.getElementById("pause-btn");

  if(isPaused){
    overlay.style.display="flex";
    btn.innerText="âšâš";   // ì¼ì‹œì •ì§€ ìƒíƒœ
  } else {
    overlay.style.display="none";
    btn.innerText="â–¶";    // ì¬ìƒ ìƒíƒœ
  }
}

/* UI */
function updateDigital(sec){
  document.getElementById("timer-digital").innerText =
    String(Math.floor(sec/60)).padStart(2,"0")+":"+String(sec%60).padStart(2,"0");
}

function updateAnalog(){
  const c=document.getElementById("circle-progress");
  const r=130; const circ=2*Math.PI*r;
  c.style.strokeDasharray=circ;
  c.style.strokeDashoffset=circ*(1 - fifteenLeft/baseTime);
}

/* ë¦¬ì…‹ */
function resetAll(){
  tasks=[]; stars=0;
  localStorage.setItem("tasks","[]");
  localStorage.setItem("stars","0");

  stopAllTimers();
  document.getElementById("mini-task").innerText="";
  document.getElementById("circle-wrapper").style.display="none";
  document.getElementById("pause-btn").style.display="none";
  document.getElementById("pause-overlay").style.display="none";
  isPaused=false;

  renderTasks(); renderBadges();
}

function stopAllTimers(){
  clearInterval(twentyTimer); clearInterval(fifteenTimer);
  twentyTimer=null; fifteenTimer=null;
}

</script>

</body>
</html>
